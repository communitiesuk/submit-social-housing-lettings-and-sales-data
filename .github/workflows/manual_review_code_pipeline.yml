name: Manual review app code pipeline

concurrency:
  group: review-${{ inputs.review_app_key }}

on:
  workflow_dispatch:
    inputs:
      review_app_key:
        required: true
        type: string
        description: "The review app ID to deploy code for."

defaults:
  run:
    shell: bash

jobs:
  code:
    name: Deploy review app code
    uses: ./.github/workflows/aws_deploy.yml
    with:
      aws_account_id: 837698168072
      aws_role_prefix: core-dev
      aws_task_prefix: core-review-${{ inputs.review_app_key }}
      concurrency_tag: ${{ inputs.review_app_key }}
      environment: review
    permissions:
      id-token: write
